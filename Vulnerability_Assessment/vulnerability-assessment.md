# Vulnerability Assessment

Comprehensive notes based on HTB CPTS table of contents, covering concepts, tools, commands, and workflows.

- Scope and Rules of Engagement
  - Define in/out of scope, time windows, contacts, escalation, data handling
  - Legal/ethical: explicit authorization, logging, safe handling of PII/creds
  - Constraints: rate limits, production-safety, out-of-hours windows
  - Deliverables: executive summary, technical details, evidence, remediation

- Methodology Overview (High-Level)
  - Reconnaissance → Enumeration → Vulnerability Identification → Validation/Exploitation (non-destructive) → Post-Exploitation (limited) → Reporting and Remediation
  - Standards: PTES, OWASP Testing Guide (web), NIST SP 800-115

- Planning & Environment
  - Build tester workstation images; snapshots; isolated lab; VPN/Proxychains
  - Version-controlled notes (Markdown) and evidence (screens, PCAP, loot)
  - Timeboxing and checklists per target

- Reconnaissance (External)
  - Passive: WHOIS, DNS, ASN, cert transparency, OSINT
    - Commands:
      - whois example.com
      - dig NS/MX/TXT +short example.com
      - amass enum -passive -d example.com
      - subfinder -d example.com
      - crt.sh query: %.example.com
      - theHarvester -d example.com -b all
      - webscreenshot / gowitness for screenshots
  - Active: confirm live hosts and services conservatively
    - nmap -sn 1.2.3.0/24
    - nmap -Pn -p 1-1000 -sS -T3 1.2.3.4
    - masscan --rate 5000 -p1-65535 1.2.3.0/24 (careful)

- DNS & Domain Mapping
  - Zone transfer test: dig axfr @ns.example.com example.com
  - Subdomain bruteforce: dnsx, gobuster dns, amass, subfinder
  - Takeover checks: subjack, nuclei templates for takeovers

- Web Enumeration
  - Tech ID: wappalyzer, httpx -tech-detect, whatweb
  - HTTP probing: httpx -l hosts.txt -sc -title -tech-detect -td -ip -cdn
  - Content discovery:
    - feroxbuster -u https://target -w /lists/dirs.txt -x php,asp,aspx,js
    - gobuster dir -u https://target -w /lists/dirs.txt -x php,txt,conf,bak
  - Parameter discovery: arjun -u https://target
  - Crawling: katana -u https://target -jc -aff -fs fqdn -kf robotstxt,sitemap
  - Auth and sessions: capture flows with Burp, note cookies, CSRF, JWTs

- TLS/Certificates
  - sslyzer/sslscan/testssl.sh for cipher/misconfig
  - testssl.sh -U --sneaky https://target

- Application Security Testing (OWASP)
  - AuthN/AuthZ: weak creds, MFA bypass, IDOR, role misconfig
  - Input validation: SQLi, XSS, SSTI, SSI, command injection, XXE
  - File upload: extension bypass, path traversal, content-type tricks
  - Business logic: workflow abuses, rate-limit, coupon abuse
  - Deserialization: ysoserial gadget chains
  - SSRF: internal access, metadata endpoints (169.254.169.254)
  - CSRF: state-changing requests without tokens or checks
  - Sensitive data exposure: verbose errors, secrets in JS, backups

- Web Vuln Tools/Workflows
  - Burp Suite: Target map, Repeater, Intruder, Collaborator, Logger++
  - Nuclei scanning:
    - httpx -l hosts.txt -silent | nuclei -t cves/ -severity critical,high
  - SQLi:
    - sqlmap -u "https://t/?id=1" --batch --dbs --risk=2 --level=2
  - XSS:
    - Param fuzz via burp or ffuf: ffuf -u https://t/FUZZ -w params.txt
  - Auth bypass/IDOR:
    - Manually test object IDs, change GUIDs, remove server-side checks

- Infrastructure Enumeration
  - Nmap deep scan: nmap -sV -sC -O -p- --min-rate 2000 10.10.10.0/24
  - UDP scan (targeted): nmap -sU -p 53,123,161,500 10.10.10.10
  - SNMP enum: onesixtyone, snmpwalk -v2c -c public 10.10.10.10 1.3.6.1.2.1
  - SMB enum:
    - smbclient -L //10.10.10.10 -N
    - crackmapexec smb 10.10.10.0/24 --shares --pass-pol
    - enum4linux-ng -A 10.10.10.10
  - RDP: xfreerdp /u:USER /p:PASS /v:10.10.10.10
  - SSH banner/keys: ssh -v user@host, check ~/.ssh/authorized_keys leaks

- Windows AD Focus
  - Null sessions, LDAP, Kerberos, SMB signing, LLMNR/NBNS
  - Kerberoasting/AS-REP roast: impacket-GetUserSPNs, GetNPUsers
  - BloodHound collection: SharpHound.exe, Python ingestor
  - Local enumeration: winPEAS, Seatbelt
  - Lateral movement: PsExec, WinRM (evil-winrm), RDP
  - Credential hunting: lsass via comsvcs.dll/minidump (with authorization)

- Linux Focus
  - Services: NFS, Docker, Redis, MySQL, Postgres, Apache, Nginx
  - Enum: linPEAS, pspy, ss -tulpen, sudo -l, id, getcap -r /
  - Common misconfigs: cron, SUID, capabilities, weak file perms

- Cloud & Containers (Brief)
  - Metadata endpoints, instance profiles, public S3/GCS buckets
  - EKS/AKS: kube-hunter, kubectl auth can-i, RBAC misconfig

- Vulnerability Identification & Confirmation
  - CVE/CVSS triage: version mapping, exploit-db, NVD, vendor advisories
  - POCs: searchsploit, Metasploit modules, Proof-of-Concept validation in dev
  - Nuclei, Nessus/OpenVAS for breadth; confirm manually

- Password Attacks (Permitted Scope Only)
  - Wordlists: seclists, rockyou, custom via CeWL
  - Online: hydra, medusa, ncrack, patator (respect lockouts)
  - Offline: hashid/hashcat/john; rules and masks
  - Kerberos: kerberoast/asrep; NTLM relay (if allowed), responder

- Wireless/Network (If in scope)
  - wardriving, aircrack-ng suite; WPA handshake capture; rogue AP (allowed?)

- Exploitation Safety
  - Prefer non-destructive checks; avoid DoS; get change approval for risky tests
  - Snapshot/backup targets when possible, monitor telemetry

- Post-Exploitation (Limited)
  - Proof of impact: whoami, hostname, id, ipconfig/ifconfig, uname -a
  - Data access checks: least privilege validation with minimal dataset
  - Persistence/AV: do not install persistence unless explicitly authorized

- Evidence & Note-Taking
  - Structure: Per target -> services -> findings -> evidence -> remediation
  - Capture requests/responses, console output, hashes of files, timestamps
  - Store credentials and tokens securely (KeePass/Pass stores)

- Reporting
  - Executive summary: risk, affected assets, business impact, priority
  - Technical details per finding: description, affected components, steps to reproduce, evidence, severity (CVSS), likelihood, impact, remediation, references
  - Remediation tracking: owners, timelines, re-test plan

- Common Commands Cheat Sheet
  - Scanning
    - nmap -sC -sV -oA scans/initial 10.10.10.0/24
    - masscan -p1-65535 --rate 5000 10.10.10.0/24 -oL scans/masscan.txt
  - Web
    - httpx -l hosts.txt -sc -title -tech-detect -td
    - nuclei -l urls.txt -t cves/ -severity critical,high
    - ffuf -u https://t/FUZZ -w /lists/dirs.txt -mc 200,301,302
  - SMB/AD
    - crackmapexec smb 10.10.10.0/24 -u '' -p '' --shares
    - impacket-GetUserSPNs -request -dc-ip 10.10.10.5 domain.local/user:pass
  - Linux priv-esc
    - linpeas.sh -a
    - find / -perm -4000 -type f 2>/dev/null
    - getcap -r / 2>/dev/null
  - Windows priv-esc
    - winPEASany.exe
    - whoami /priv && icacls C:\Sensitive

- Validation Workflow (Per Finding)
  1) Identify potential weakness (banner/version/behavior)
  2) Map to known issues (CVE, CWE, pattern)
  3) Create minimal PoC in a safe, isolated context
  4) Confirm repeatability; collect evidence
  5) Assess severity and likelihood; consider compensating controls
  6) Draft remediation with concrete steps

- Engagement Workflow (Per Target)
  1) Define objectives & scope constraints
  2) Recon & enumerate services/tech stack
  3) Prioritize attack paths by likelihood/impact
  4) Test hypotheses methodically, log all attempts
  5) Validate findings; avoid destructive actions
  6) Report and brief stakeholders; plan re-test

- Ethics & Safe Handling
  - Minimize data exposure; immediately report sensitive data encountered
  - Use strong opsec: VPN, separate profiles, avoid personal accounts
  - Follow client change control; stop testing on instability

- Tools List (Non-exhaustive)
  - Recon: amass, subfinder, assetfinder, theHarvester, Shodan/Censys
  - Web: Burp, httpx, nuclei, feroxbuster, gobuster, ffuf, arjun, katana
  - Infra: nmap, masscan, smbclient, crackmapexec, enum4linux, snmpwalk
  - AD: impacket suite, BloodHound, Rubeus
  - Linux/Windows enum: linPEAS, winPEAS, Seatbelt, pspy
  - Cloud/containers: kubectl, kube-hunter, trivy

- Appendix: References
  - PTES, NIST 800-115, OWASP Testing Guide, OWASP ASVS
  - Cheat sheets: PayloadsAllTheThings, GTFOBins, LOLBAS
